#!/bin/bash -l

path_in="${1}"
path_out=${2}
path_log=${3}
suffix=${4}
snr=${5}
noise_estimate=${6}


echo "input path for computation:"
echo $path_in
echo "output path for computation:"
echo $path_out
echo "log path for computation:"
echo $path_log
echo "specific suffix:"
echo $suffix
echo "SNR cut:"
echo $snr
echo "noise estimate for p1d:"
echo $noise_estimate

if [[ ${suffix} == "None" ]]
then
suffix_flag=""
else
suffix_flag=${suffix}
fi





mkdir -p ${path_log}

mkdir -p ${path_out}/pk1d_SNRcut${snr}

picca_Pk1D.py \
--in-dir ${path_out}/deltas \
--in-format fits \
--out-dir ${path_out}/pk1d_SNRcut${snr} \
--lambda-obs-min 3750. \
--noise-estimate ${noise_estimate} \
--pixel-correction inverse \
--nproc ${nb_proc} \
--use-desi-new-defaults \
--nb-pixel-masked-max 120 \
--nb-part 3 \
--SNR-min ${snr} \
--nb-noise-exp 2500 > ${path_log}/p1d_output_SNRcut${snr} 2> ${path_log}/p1d_error_SNRcut${snr}
